<!DOCTYPE html>
<html lang="english">
<head>
          <title>Jack McKew's Blog - Python Project Workflow</title>
        <meta charset="utf-8" />




    <meta name="tags" content="python" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://jackmckew.dev/">Jack McKew's Blog <strong>Python enthusiast, electrical engineer and tinkerer</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/archives.html">Archives</a></li>
            <li><a href="/categories.html">Categories</a></li>
            <li><a href="/tags.html">Tags</a></li>
            <li><a href="/sitemap.xml">Sitemap</a></li>
            <li><a href="https://jackmckew.dev/pages/contact.html">Contact</a></li>
            <li><a href="https://jackmckew.dev/pages/cv-professional.html">CV/Professional</a></li>
            <li><a href="https://jackmckew.dev/category/android.html">Android</a></li>
            <li><a href="https://jackmckew.dev/category/book-reviews.html">Book Reviews</a></li>
            <li><a href="https://jackmckew.dev/category/data-science.html">Data Science</a></li>
            <li><a href="https://jackmckew.dev/category/engineering.html">Engineering</a></li>
            <li><a href="https://jackmckew.dev/category/engineering-python.html">Engineering, Python</a></li>
            <li><a href="https://jackmckew.dev/category/machine-learning.html">Machine Learning</a></li>
            <li><a href="https://jackmckew.dev/category/principles.html">Principles</a></li>
            <li><a href="https://jackmckew.dev/category/python.html">Python</a></li>
            <li><a href="https://jackmckew.dev/category/python-data-science.html">Python, Data Science</a></li>
            <li><a href="https://jackmckew.dev/category/python-engineering.html">Python, Engineering</a></li>
            <li class="active"><a href="https://jackmckew.dev/category/python-principles.html">Python, Principles</a></li>
            <li><a href="https://jackmckew.dev/category/software-development.html">Software Development</a></li>
            <li><a href="https://jackmckew.dev/category/software-development-data-science.html">Software Development, Data Science</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://jackmckew.dev/python-project-workflow.html" rel="bookmark"
         title="Permalink to Python Project Workflow">Python Project Workflow</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2019-08-30T06:30:00+10:00">
      Fri 30 August 2019
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://jackmckew.dev/author/jack-mckew.html">Jack McKew</a>
    </address>
    <div class="category">
        Category: <a href="https://jackmckew.dev/category/python-principles.html">Python, Principles</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://jackmckew.dev/tag/python.html">python</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>This post will go through my personal preference on project structure and workflow for creating a new project and an insight how I work on my projects from a development point of view. I will go from the very start as if I did not have Python/Git installed on my machine whatsoever.</p>
<p>First of all, we need to get Python! Head over to <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a> to get the version of Python you need (or default to the latest Python 3 stable release). For version control in my projects, I also like to use Git so, head on over to <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a> to download Git for your operating system.</p>
<p>Now once these are installed (if you put them in the default location), Python will default to be located in: C:\Users\Jack\AppData\Local\Programs\Python\Python37-32. For the next few steps to ensure we are setting up virtual environments for our projects open command prompt here if you are on windows. This will look something like this:</p>
<p><img alt="" src="..\img\python-project-workflow\image-11.png"></p>
<p>The 'cd' command in windows (and other OS) stands for change directory, follow this with a path and you will be brought to that directory. Next whenever I first install Python I like to update pip to it's latest release, to do this use the command in this window:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>python -m pip install --upgrade pip
</pre></div>
</td></tr></table>

<p>With pip upgraded to it's current release, it's time to install some very helpful packages for setting up projects: virtualenv and cookiecutter. To install these navigate to the the Scripts folder within the current directory with cd ('cd Scripts') and run 'pip.exe install virtualenv cookiecutter', pip will then work it's magic and install these packages for you.</p>
<p>If you take a peek into the Scripts folder now in your Python directory, it'll look a little like this:</p>
<p><img alt="" src="..\img\python-project-workflow\image-2.png">
Now something that I personally like to do is add this folder to your system environment variables in Windows so it's much easier to run any packages in your root Python installation on your PC. To do this:</p>
<ol>
<li>type in 'system environment' into the search command</li>
<li>select environment variables from the bottom right corner</li>
<li>edit system (or user) path variable</li>
<li>browse and select the Scripts directory in your Python installation</li>
</ol>
<p>If you chose to do this step, you will now be able to create virtual environments and cookiecutter templates without having to specify the directory to the executables.</p>
<p>It's now time to create a project from scratch. So navigate to where you like to keep your projects (mostly mine is in Documents\Github\) but you can put them anywhere you like. Now run command prompt again (or keep the one you have open) and navigate to the dedicated folder (or folders) using cd.</p>
<p>For most of my projects lately being of data science in nature, I like to use the cookiecutter-data-science template which you can find all the information about here: <a href="https://drivendata.github.io/cookiecutter-data-science/">https://drivendata.github.io/cookiecutter-data-science/</a>. To then create a project it is as simple as running:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>cookiecutter https://github.com/drivendata/cookiecutter-data-science
</pre></div>
</td></tr></table>

<p><img alt="" src="..\img\python-project-workflow\image-3.png"></p>
<p>Provide as much information as you wish into the questions and you will now have a folder created wherever you ran the command with all the relevant sections from the template.</p>
<p>Whenever starting a new Python project, my personal preference is to keep the virtual environment within the directory, however this is not always a normal practice. To create a virtual environment for our Python packages, navigate into the project and run (if you added Scripts to your Path):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>virtualenv env
</pre></div>
</td></tr></table>

<p>This will then initialise a folder within your current directory to install a copy of Python and all it's relevant tools with a folder ('env').</p>
<p>Before we go any further, this is the point that I like to initialise a git repository. To do this, run git init from your command line from within the project directory.</p>
<p>Now to finish off the final steps of the workflow that will affect the day-to-day development, I like to use pre-commit hooks to reformat my with black and on some projects check for PEP conformance with flake8 on every commit to my projects repository. This is purely a personal preference on how you would like to work, others like to use pytest and more to ensure their projects are working as intended, however I am not at that stage just yet.</p>
<p>To install these pre-commits into our workflow, firstly initialise the virtual environment from within our project by navigating to env/Scripts/activate.bat. This will activate your project's Python package management system and runtime, following this you can install packages from pip and otherwise. For our pre-commits we install the package 'pre-commit':</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>pip install pre-commit
</pre></div>
</td></tr></table>

<p>Following this to set up the commit hooks create a '.pre-commit-config.yaml' within your main project directory. This is where we will specify what hooks we would like to run before being able to commit. Below is a sample .pre-commit-config.yaml that I use in my projects:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span>repos:
-   repo: https://github.com/ambv/black
    rev: stable
    hooks:
    - id: black
      language_version: python3.7
-   repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v2.3.0
    hooks:
    -   id: flake8
    -   id: check-yaml
    -   id: end-of-file-fixer
    -   id: trailing-whitespace
</pre></div>
</td></tr></table>

<p>Now to install these, activate your virtual environment like above, navigate to the project directory and run 'pre-commit install'. This will install the pre-commit hooks within your git directory. Before going any further, I highly recommend to run 'pre-commit run --all-files' to both ensure pre-commit is working as expected and check if there is any project specific settings you may have to set.</p>
<p>On the default cookiecutter data science template with the settings as per above this will show on the pre-commit run (after you have staged changes in git (use git add -A for all)):</p>
<p><img alt="" src="..\img\python-project-workflow\image-4.png"></p>
<p>We can see a different opinions in code formatting appearing already from flake8's output. The black code formatter in Python's code length is 88 characters , not 79 like PEP8. So we will add a pyproject.toml to the project directory where we can specify settings within the black tool:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">tool.black</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">line-length = 79</span>
<span class="l l-Scalar l-Scalar-Plain">include = &#39;\.pyi?$&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">exclude = &#39;&#39;&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">/(</span>
    <span class="l l-Scalar l-Scalar-Plain">\.git</span>
  <span class="l l-Scalar l-Scalar-Plain">| \.hg</span>
  <span class="l l-Scalar l-Scalar-Plain">| \.mypy_cache</span>
  <span class="l l-Scalar l-Scalar-Plain">| \.tox</span>
  <span class="l l-Scalar l-Scalar-Plain">| \.venv</span>
  <span class="l l-Scalar l-Scalar-Plain">| \.docs</span>
  <span class="l l-Scalar l-Scalar-Plain">| _build</span>
  <span class="l l-Scalar l-Scalar-Plain">| buck-out</span>
  <span class="l l-Scalar l-Scalar-Plain">| build</span>
  <span class="l l-Scalar l-Scalar-Plain">| dist</span>
<span class="l l-Scalar l-Scalar-Plain">)/</span>
<span class="l l-Scalar l-Scalar-Plain">&#39;&#39;&#39;</span>
</pre></div>
</td></tr></table>

<p>For any flake8 specific settings (such as error codes to ignore), we can set a .flake8 file in the project directory as well, which may look like:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">flake8</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">ignore = E203, E266, E501, W503, F403, F401</span>
<span class="l l-Scalar l-Scalar-Plain">max-line-length = 88</span>
<span class="l l-Scalar l-Scalar-Plain">max-complexity = 18</span>
<span class="l l-Scalar l-Scalar-Plain">select = B,C,E,F,W,T4,B9</span>
</pre></div>
</td></tr></table>

<p>Finally we are able to run a commit to our project!</p>
<p><img alt="" src="..\img\python-project-workflow\image-5.png"></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>