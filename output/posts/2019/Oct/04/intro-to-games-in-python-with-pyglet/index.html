
<!DOCTYPE html>
<html lang="english">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://nifty-engelbart-ce3324.netlify.com/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://nifty-engelbart-ce3324.netlify.com/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://nifty-engelbart-ce3324.netlify.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://nifty-engelbart-ce3324.netlify.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://nifty-engelbart-ce3324.netlify.com/theme/font-awesome/css/solid.css">

    <link href="https://nifty-engelbart-ce3324.netlify.com/static/custom.css" rel="stylesheet">



    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">



<meta name="author" content="Jack McKew" />
<meta name="description" content="Recently, I&#39;ve been researching ways that I could run a 2D simulation (and hopefully 3D) with many moving pieces and there was a desire to make it interactive as well. I stumbled through many visualisation frameworks such as: p5 pygame plotly panda3d bokeh many others Eventually, through the motivation of …" />
<meta name="keywords" content="python, pyglet">

<meta property="og:site_name" content="Jack McKew's Blog"/>
<meta property="og:title" content="Intro to Games in Python with Pyglet"/>
<meta property="og:description" content="Recently, I&#39;ve been researching ways that I could run a 2D simulation (and hopefully 3D) with many moving pieces and there was a desire to make it interactive as well. I stumbled through many visualisation frameworks such as: p5 pygame plotly panda3d bokeh many others Eventually, through the motivation of …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://nifty-engelbart-ce3324.netlify.com/posts/2019/Oct/04/intro-to-games-in-python-with-pyglet/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-10-04 06:30:00+10:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://nifty-engelbart-ce3324.netlify.com/author/jack-mckew.html">
<meta property="article:section" content="misc"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="pyglet"/>
<meta property="og:image" content="img/jm-photo">

  <title>Jack McKew's Blog &ndash; Intro to Games in Python with Pyglet</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://nifty-engelbart-ce3324.netlify.com">
        <img src="img/jm-photo" alt="Jack McKew's Blog" title="Jack McKew's Blog">
      </a>
      <h1><a href="https://nifty-engelbart-ce3324.netlify.com">Jack McKew's Blog</a></h1>

<p>Python enthusiast, electrical engineer and tinkerer</p>
      <nav>
        <ul class="list">
          <li><a href="https://nifty-engelbart-ce3324.netlify.com/pages/contact.html#contact">Contact</a></li>
          <li><a href="https://nifty-engelbart-ce3324.netlify.com/pages/cv-professional.html#cv-professional">CV/Professional</a></li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-twitter" href="https://twitter.com/Jac_McQ" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/jack-mckew/" target="_blank">
            <i class="fab fa-linkedin">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="https://github.com/JackMcKew" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://nifty-engelbart-ce3324.netlify.com">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/tags.html">Tags</a>
      <a href="/sitemap.xml">Sitemap</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="intro-to-games-in-python-with-pyglet">Intro to Games in Python with Pyglet</h1>
    <p>
          Posted on Fri 04 October 2019 in <a href="https://nifty-engelbart-ce3324.netlify.com/category/misc.html">misc</a>


        &#8226; 3 min read
    </p>
  </header>


  <div>
    <body><p>Recently, I've been researching ways that I could run a 2D simulation (and hopefully 3D) with many moving pieces and there was a desire to make it interactive as well. I stumbled through many visualisation frameworks such as:</p>
<ul>
<li><a href="https://pypi.org/project/p5/">p5</a></li>
<li><a href="https://www.pygame.org/news">pygame</a></li>
<li><a href="https://plot.ly/">plotly</a></li>
<li><a href="https://www.panda3d.org/">panda3d</a></li>
<li><a href="https://bokeh.pydata.org/en/latest/">bokeh</a></li>
<li>many others</li>
</ul>
<p>Eventually, through the motivation of another side project (looking into training neural networks to learn how to play games) and inspired by this video from Code Bullet <a href="https://www.youtube.com/watch?v=r428O_CMcpI">https://www.youtube.com/watch?v=r428O_CMcpI</a>; I decided on attempting to use <a href="https://pyglet.readthedocs.io/en/stable/">Pyglet</a> to do these simulations.</p>
<p>While the aforementioned simulations won't be covered in this post, this post aims to demonstrate how I adapted the <a href="https://pyglet.readthedocs.io/en/stable/programming_guide/examplegame.html">in-depth tutorial on the Pyglet website</a> (which goes through how to recreate asteroids in Pyglet) to generate vector based objects which can crash into each other.</p>
<p>First off as always, start by setting up a virtual environment with your preferred method (<a href="https://jmckew.com/2019/01/11/episode-8-anaconda/">Anaconda</a> or <a href="https://jmckew.com/2019/08/30/python-project-workflow/">follow my workflow</a>), since Pyglet has no external dependencies, all you need to do is install the pyglet package.</p>
<p>I won't go through all the code in the example, and how it works, I will only go through what I changed in the case to get where I wanted to go.</p>
<p>To begin, and make things a bit easier, I downloaded the pyglet-master repository from GitHub (<a href="https://github.com/pyglet/pyglet">https://github.com/pyglet/pyglet</a>) so I didn't have to create and copy the file contents one by one.</p>
<p>After going through the different versions with the examples &gt; game folder, I decided all I required was the simple functionality of collision and any further into developing the game wasn't needed for this stage, so I copied out the version 3 folder.</p>
<p>If we run 'asteroid.py' from within the version 3 folder, we are met with this screen</p>
<p><img alt="" src="..\img\intro-to-games-in-python-with-pyglet\image.png"/></p>
<p>Now since all I am trying to do is generate multiple objects (which will be shown with the player symbol to indicate direction), I can comment out the lines which give the lives, score, title and interactive player.</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="c1"># Set up the two top labels</span></span>
<span class="code-line"><span class="c1"># score_label = pyglet.text.Label(text="Score: 0", x=10, y=575, batch=main_batch)</span></span>
<span class="code-line"><span class="c1"># level_label = pyglet.text.Label(text="Version 3: Basic Collision",</span></span>
<span class="code-line"><span class="c1">#                                 x=400, y=575, anchor_x='center', batch=main_batch)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Initialize the player sprite</span></span>
<span class="code-line"><span class="c1"># player_ship = player.Player(x=400, y=300, batch=main_batch)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Make three sprites to represent remaining lives</span></span>
<span class="code-line"><span class="c1"># player_lives = load.player_lives(2, main_batch)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Make three asteroids so we have something to shoot at </span></span>
<span class="code-line"><span class="c1"># asteroids = load.asteroids(3, player_ship.position, main_batch)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">asteroids</span> <span class="o">=</span> <span class="n">load</span><span class="o">.</span><span class="n">asteroids</span><span class="p">(</span><span class="mi">100</span><span class="p">,(</span><span class="n">window_width</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">window_height</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span><span class="n">main_batch</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Store all objects that update each frame in a list</span></span>
<span class="code-line"><span class="c1"># game_objects = [player_ship] + asteroids</span></span>
<span class="code-line"><span class="n">game_objects</span> <span class="o">=</span> <span class="n">asteroids</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Tell the main window that the player object responds to events</span></span>
<span class="code-line"><span class="c1"># game_window.push_handlers(player_ship.key_handler)</span></span>
</pre></div>
<p>Now that we've done that, we need to modify the asteroids generator function to use the player sprite.</p>
<p>In load.py, you can change simply the img argument to the player image sprite reference like so:</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="n">new_asteroid</span> <span class="o">=</span> <span class="n">physicalobject</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">(</span><span class="n">img</span><span class="o">=</span><span class="n">resources</span><span class="o">.</span><span class="n">player_image</span><span class="p">,</span>                                                     <span class="n">x</span><span class="o">=</span><span class="n">asteroid_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">asteroid_y</span><span class="p">,</span>                                                 <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span></span>
</pre></div>
<p>Now if we run this, the animation will look a little off, because the objects won't be traveling the direction in the direction that the sprite is pointing. This is due to the existing velocity calculation being a random number for both the X and Y component.</p>
<p>To make the player sprites move in the direction they are rotated in, and maintain the existing codebase, we will need to convert from <a href="https://www.mathsisfun.com/polar-cartesian-coordinates.html">polar notation to cartesian</a>.</p>
<p>To do this, we add an extra 2 functions into 'util.py' which will do this for us:</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="k">def</span> <span class="nf">cart2pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">rho</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">phi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></span>
<span class="code-line">    <span class="k">return</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">def</span> <span class="nf">pol2cart</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">x</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span></span>
<span class="code-line">    <span class="n">y</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span></span>
<span class="code-line">    <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></span>
</pre></div>
<p>Note the use of radians in pol2cart, this is due to the <a href="https://www.sparknotes.com/math/trigonometry/trigonometricfunctions/section3/">affect of quadrants and trigonometric functions</a>. I won't go into detail, but it won't behave like you expect it to.</p>
<p>Now to get our player sprites moving in the direction they are rotated, update the code which generates the 'asteroids' to utilise our new function:</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="n">new_asteroid</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span></span>
<span class="code-line"><span class="n">new_asteroid</span><span class="o">.</span><span class="n">velocity_speed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">40</span></span>
<span class="code-line"><span class="n">new_asteroid</span><span class="o">.</span><span class="n">velocity_x</span><span class="p">,</span> <span class="n">new_asteroid</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">pol2cart</span><span class="p">(</span><span class="n">new_asteroid</span><span class="o">.</span><span class="n">velocity_speed</span><span class="p">,</span><span class="n">new_asteroid</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span></span>
</pre></div>
<p>Now when we go and run our main file again, we will met with a screen like this:</p>
<p><img alt="" src="..\img\intro-to-games-in-python-with-pyglet\image-1.png"/></p>
<p>Where the player sprites will float around in the direction they are pointing, until they crash into another sprite, causing both of them to disappear.</p>
<p>This is a quick intro to Pyglet, I am hoping to expand on this simulation and am positive I will be doing further write ups with it in the future.</p></body>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://nifty-engelbart-ce3324.netlify.com/tag/python.html">python</a>
      <a href="https://nifty-engelbart-ce3324.netlify.com/tag/pyglet.html">pyglet</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack McKew's Blog ",
  "url" : "https://nifty-engelbart-ce3324.netlify.com",
  "image": "img/jm-photo",
  "description": ""
}
</script>

</body>
</html>